CREATE s(
X STRING,
Y STRING;
CHECK (NOT Y = 'NULL')
),

CREATE v(
X STRING
);

ON SOURCE[s], VIEW v:

INSERT {X, Y} INTO s
WHEN NOT { X, _} IN s
THEN INSERT {X} INTO v,

FORALL Y SUCH THAT { X, Y} IN s DO [DELETE {X, Y} FROM s]
WHEN { X, _} IN s
THEN DELETE {X} FROM v.